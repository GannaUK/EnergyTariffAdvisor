@page
@model EnergyTariffAdvisor.Pages.OctopusTestModel

<h2>Octopus Energy Products</h2>

@if (Model.Products.Any())
{
    <div id="products-list">
        @foreach (var product in Model.Products)
        {
            <details style="margin-bottom: 1rem;" id="product-@product.Code">
                <summary style="cursor: pointer; font-weight: bold;">
                    @product.DisplayName (@product.Code)
                </summary>
                <ul style="margin-top: 0.5rem;">
                    <li><strong>Direction:</strong> @product.Direction</li>
                    <li><strong>Green:</strong> @(product.IsGreen ? "Yes" : "No")</li>
                    <li><strong>Variable:</strong> @(product.IsVariable ? "Yes" : "No")</li>
                    <li><strong>Available from:</strong> @product.AvailableFrom.ToShortDateString()</li>
                    <li><strong>Description:</strong> @product.Description</li>
                </ul>
                @if (product.Links != null && product.Links.Any())
                {
                    <p><strong>API Links:</strong></p>
                    <ul>
                        @foreach (var link in product.Links)
                        {
                            <li><a href="@link.Href" target="_blank">@link.Rel</a></li>
                        }
                    </ul>
                }
                @if (Model.TariffsByProduct.ContainsKey(product.Code))
                {
                    <div style="margin-left: 1rem; margin-top: 1rem;">
                        <h5>Tariffs:</h5>
                        <ul style="list-style-type:none; padding-left: 0;">
                            @foreach (var tariff in Model.TariffsByProduct[product.Code])
                            {
                                <li style="
                        margin-bottom: 1rem;
                        padding: 1rem;
                        border: 1px solid #ddd;
                        border-radius: 8px;
                        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                        background-color: #f9f9f9;">
                                    <p><strong>Code:</strong> @tariff.Code</p>
                                    <p><strong>Standing Charge (inc VAT):</strong> @tariff.StandingChargeIncVat.ToString("0.###") p/day</p>
                                    <p><strong>Unit Rate (inc VAT):</strong> @tariff.StandardUnitRateIncVat.ToString("0.###") p/kWh</p>
                                    <p><strong>Exit Fees Type:</strong> @tariff.ExitFeesType</p>
                                </li>
                            }
                        </ul>
                    </div>
                }
                else
                {
                    <p>No tariff details loaded yet.</p>
                }
            </details>
        }
    </div>
}
else
{
    <p>Loading or no data available.</p>
}