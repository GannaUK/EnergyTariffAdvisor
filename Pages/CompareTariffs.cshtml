@page
@model EnergyTariffAdvisor.Pages.CompareTariffsModel
@using EnergyTariffAdvisor.Models
@{
}
<h2>Compare Energy Tariffs</h2>



<hr />

<h4 class="mt-4">1. Choose Tariffs to Compare</h4>

<form method="post" asp-page-handler="LoadOctopus">
    <button type="submit" class="btn btn-primary mb-3">
        Load Octopus Tariffs
    </button>
</form>

<form method="post" asp-page-handler="Calculate">
    @if (Model.AvailableTariffs.Any())
    {
        <table class="table table-striped table-bordered align-middle">
            <thead>
                <tr>
                    <th>Select</th>
                    <th>Details</th>
                    <th>Tariff Type</th>
                    <th>Tariff Code</th>
                    <th>Unit Rate (p/kWh)</th>
                    <th>Standing Charge (p/day)</th>
                </tr>
            </thead>
            <tbody>
                @for (int i = 0; i < Model.AvailableTariffs.Count; i++)
                {
                    var tariff = Model.AvailableTariffs[i];
                    <tr>
                        <td>
                            <input type="checkbox" value="@i" name="SelectedTariffs" />
                        </td>
                        <td>
                            <a asp-page-handler="ViewDetails"
                               asp-route-index="@i"
                               class="btn btn-sm btn-info">
                                Details
                            </a>
                        </td>
                        <td>@tariff.TariffType</td>
                        <td>@tariff.TariffCode</td>
                        <td>@tariff.GetUnitRateDisplay()</td>
                        <td>@tariff.StandingChargeDaily.ToString("0.##")</td>
                    </tr>
                }
            </tbody>
        </table>
        <button type="submit" class="btn btn-success">Calculate</button>
    }
    else
    {
        <p>No tariffs available.</p>
    }
</form>

<h4 class="mt-4">3. Add Official Tariff from OFGEM (optional)</h4>
<p>
    What is a default Ofgem’s price cap?
    A default tariff (also known as a standard variable tariff) is the type of energy plan customers are automatically placed on if they do not choose a specific deal. 
    All energy suppliers are required to offer this type of tariff, and its prices are protected by the government through Ofgem’s price cap. 
    This means suppliers cannot charge more than the maximum rates set by the regulator.

    <br />
<form method="post" asp-page-handler="AddOFGEMTariff">
    <div class="row">
        <div class="col-md-4">
            <label class="form-label">Tariff Name</label>
            <input type="text" class="form-control" name="OFGEMTariffName" value="OFGEN-DEFAULT-2025" />
        </div>
        <div class="col-md-4">
            <label class="form-label">Unit Rate (p/kWh)</label>
            <input type="number" step="0.01" class="form-control" name="OFGEMUnitRate" value="27.35" />
        </div>
        <div class="col-md-4">
            <label class="form-label">Standing Charge (p/day)</label>
            <input type="number" step="0.01" class="form-control" name="OFGEMStandingCharge" value="58.69" />
        </div>
    </div>
    <button type="submit" class="btn btn-primary mt-3">Add Tariff</button>
</form>

<h4 class="mt-4">4. Add Your Current Tariff (optional)</h4>
<form method="post" asp-page-handler="AddManualTariff">
    <div class="row">
        <div class="col-md-4">
            <label class="form-label">Tariff Name</label>
            <input type="text" class="form-control" name="ManualTariffName" value="My Current Tariff"/>
        </div>
        <div class="col-md-4">
            <label class="form-label">Unit Rate (p/kWh)</label>
            <input type="number" step="0.01" class="form-control" name="ManualUnitRate" />
        </div>
        <div class="col-md-4">
            <label class="form-label">Standing Charge (p/day)</label>
            <input type="number" step="0.01" class="form-control" name="ManualStandingCharge" />
        </div>
    </div>
    <button type="submit" class="btn btn-primary mt-3">Add Tariff</button>
</form>